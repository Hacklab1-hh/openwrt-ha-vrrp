# Konzepte reviewfix17_a4

Diese Teilfassung führt ein Preset‑System ein und dokumentiert die Annahmen zu unterstützten OpenWrt‑Versionen sowie den Ablauf eines Versionssprungs.

## Preset‑System

- **Dev‑Preset**: Für Entwickler:innen, die unter Linux oder Windows arbeiten.  Es definiert Pfade für lokale Spiegel (`_workspace/vrrp-repo`), Download‑Ordner, IPK‑Repository und den aktuellen Arbeitsordner.  Der Installer verwendet diese Angaben, um das aktuellste lokale Paket zu installieren.  Ein Helper‑Skript verschiebt alle heruntergeladenen Tar‑, Zip‑ und IPK‑Dateien aus dem Download‑Ordner in das Arbeitsverzeichnis, sodass diese per `scp` auf OpenWrt‑Nodes übertragen werden können.
- **Node‑Preset**: Für Produktivsysteme (OpenWrt).  Es legt Basisverzeichnisse wie `/root/openwrt-ha-vrrp-current`, `/root/openwrt-ha-vrrp-repo` und `/root/vrrp-ipk-repo` fest.  Der Installer lädt dort Archive aus dem lokalen Repo, erstellt Backups und führt das Setup aus.  Dadurch bleibt das System unabhängig von der Entwicklungsumgebung.
- **OpenWrt‑Versionsermittlung**: Die Preset‑Konfiguration ermöglicht es, eine *ermittelte* oder *angenommene* OpenWrt‑Version für die Zielhardware zu hinterlegen.  Für Mango/GL‑MT300N‑V2 ist OpenWrt 22.03.4 aktuell【92603978916730†L320-L322】, für Lamobo R1 existiert aufgrund der DSA‑Umstellung kein Migrationspfad von 19.07 auf 22.03【633554760445073†L148-L156】 (daher Neuinstallation erforderlich), und für x86‑Geräte können Upgrades per sysupgrade von 21.02 über 22.03 auf 23.05 durchgeführt werden【878966515062870†L23-L27】.  Diese Informationen dienen dazu, den Nutzer:innen sinnvolle Upgrade‑Vorschläge zu machen.
- **Device‑Profile**: In `presets.json` sind Geräteprofile hinterlegt, die upgradefähige OpenWrt‑Versionen sowie EOL‑Hinweise enthalten.  Sie können genutzt werden, um Anwender:innen zu warnen oder alternative Pfade (Neuinstallation) vorzuschlagen.

## Versionssprung‑Workflow

- **Automatische Dokumentenaktualisierung**: Wie bereits in *reviewfix17_a3* beschrieben, steuert `config/doc_aggregation.json`, ob historische Teilfassungen an zentrale Dokumente angehängt oder ersetzt werden.  Dieses Verhalten bleibt bestehen; der Versionsbump auf `reviewfix17_a4` sorgt lediglich dafür, dass eine neue Teilfassung in den Archiven erscheint.
- **Konfigurationsgestützte Installation**: Der Installer liest das ausgewählte Preset, nutzt die definierte Verzeichnisstruktur und führt das Installationsskript aus dem jeweiligen `VERSION`‑Unterordner aus.  So kann die Installation sowohl in einer Entwicklungsumgebung als auch auf einem Router erfolgen, ohne dass Pfade manuell angepasst werden müssen.
- **Dev‑Workflow für Archivierung**: Im Dev‑Preset verschiebt ein Helper‑Skript alle geladenen Artefakte (z. B. IPK‑ und Tar‑Dateien) aus dem Download‑Ordner in das Arbeitsverzeichnis `_workspace/vrrp-repo`.  Anschließend können diese Dateien via `scp` auf die Nodes kopiert werden, um offline installiert zu werden.

Diese neuen Konzepte gewährleisten, dass sich das Add‑on sowohl in der Entwicklungsumgebung als auch im produktiven Einsatz nahtlos installieren, updaten und debuggen lässt.  Sie machen das Projekt zukunftssicher und erleichtern das Arbeiten mit unterschiedlichen Geräten und OpenWrt‑Versionen.